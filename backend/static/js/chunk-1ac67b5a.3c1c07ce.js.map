{"version":3,"sources":["webpack:///./src/views/CreateResponse.vue?91ba","webpack:///./src/views/CreateResponse.vue?bb1d","webpack:///./src/views/CreateResponse.vue?5830"],"names":["class","ref","style","api_data","event","form","title","name","id","method","submit","sections","element","index","key","section","hide_section_numbers","section_name","length","questions","question","questionIndex","set","qid","required","for","properties","field_type","question-index","section-index","value","content","answer","updateAnswer","submit_message","error","response","undefined","error-message","success-duration","success-message","success","loading","submit-text","cancel-text","cancel-confirmation","cancel-conf-button","hide","leave","components","Object","assign","Submit","fields","data","created","Promise","all","get","concat","$route","params","then","query","edit","initializeData","methods","this","$nextTick","$refs","scrollIntoView","behavior","location","href","url","successMessage","options","headers","transformResponse","JSON","parse","e","sectionIndex","render","__scopeId"],"mappings":"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","file":"js/chunk-1ac67b5a.3c1c07ce.js","sourcesContent":["<template>\r\n  <div\r\n    v-if=\"api_data && event && form\"\r\n    class=\"box\"\r\n  >\r\n    <h1\r\n      ref=\"formtitle\"\r\n      class=\"title\"\r\n    >\r\n      {{ api_data.title }}<template v-if=\"event\">\r\n        ({{ event.name }})\r\n      </template>\r\n    </h1>\r\n    <hr>\r\n    <form\r\n      id=\"form-area\"\r\n      class=\"flex column\"\r\n      method=\"post\"\r\n      @submit.prevent=\"submit\"\r\n    >\r\n      <ul class=\"steps has-content-centered mb-0\">\r\n        <li\r\n          v-for=\"(element, index) in api_data.form.sections\"\r\n          :key=\"element.id\"\r\n          class=\"steps-segment is-primary\"\r\n          :class=\"{'is-active' : section == index, 'has-gaps' : section <= index}\"\r\n        >\r\n          <span class=\"steps-marker\"><template v-if=\"!api_data.form.hide_section_numbers\">{{ index+1 }}</template></span>\r\n          <div class=\"steps-content\">\r\n            <p :class=\"{'has-text-weight-bold' : section == index}\">\r\n              {{ element.section_name }}\r\n            </p>\r\n          </div>\r\n        </li>\r\n        <li\r\n          class=\"steps-segment is-primary\"\r\n          :class=\"{'is-active' : section == api_data.form.sections.length}\"\r\n        >\r\n          <span class=\"steps-marker\"><template v-if=\"!api_data.form.hide_section_numbers\"> {{ api_data.form.sections.length+1 }} </template></span>\r\n          <div class=\"steps-content\">\r\n            <p>\r\n              Concluída\r\n            </p>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n      <div\r\n        v-if=\"section < api_data.form.sections.length\"\r\n        class=\"box\"\r\n      >\r\n        <div\r\n          v-for=\"(question, questionIndex) in api_data.form.sections[section].questions\"\r\n          :key=\"question.id\"\r\n          :set=\"(qid = 's' + section + '_q' + questionIndex)\"\r\n        >\r\n          <label\r\n            class=\"label\"\r\n            :class=\"{'required' : question.required}\"\r\n            :for=\"qid\"\r\n          >\r\n            <span\r\n              v-if=\"\r\n                !api_data.form.hide_question_numbers &&\r\n                  !api_data.form.sections[section].hide_question_numbers\r\n              \"\r\n            >{{ questionIndex + 1 }}. </span>{{ question.question\r\n            }}</label>\r\n          <component\r\n            :is=\"question.properties.field_type\"\r\n            :question=\"question\"\r\n            :question-index=\"questionIndex\"\r\n            :section-index=\"section\"\r\n            :value=\"form.content.sections[section][questionIndex].answer\"\r\n            :qid=\"qid\"\r\n            @update=\"updateAnswer\"\r\n          />\r\n          <hr\r\n            v-if=\"questionIndex < api_data.form.sections[section].questions.length-1\"\r\n            class=\"mt-4 mb-4\"\r\n            style=\"width: 100%; height: 1px; background-color: #ddd\"\r\n          >\r\n        </div> \r\n      </div>\r\n      <div\r\n        v-else\r\n        v-html=\"api_data.submit_message\"\r\n      />\r\n      <Submit \r\n        :error=\"response && response.id === undefined\"\r\n        error-message=\"Houve um erro na submissão do formulário.\"\r\n        success-duration=\"3000\"\r\n        :success-message=\"success\"\r\n        :loading=\"loading\"\r\n        :submit-text=\"section < api_data.form.sections.length-1 ? 'Seguinte' : 'Submeter'\"\r\n        :cancel-text=\"section > 0 ? 'Anterior' : 'Sair'\"\r\n        :cancel-confirmation=\"section == 0 ? 'Deseja sair?&nbsp;<b>A sua resposta não será guardada.</br>' : undefined\"\r\n        cancel-conf-button=\"Sair\"\r\n        :hide=\"section == api_data.form.sections.length\"\r\n        @leave=\"leave()\"\r\n        @dismissed=\"response = undefined; success = undefined\"\r\n      />\r\n      <div v-if=\"false\">\r\n        Informação a ser enviada:\r\n        <pre class=\"mt-1 mb-4\"><code>{{ JSON.stringify(form, null, '  ') }}</code></pre>\r\n        <template v-if=\"response\">\r\n          Resposta do servidor: \r\n          <pre class=\"mt-1\"><code>{{ JSON.stringify(response, null, '  ') }}</code></pre>\r\n          <!-- <pre class=\"mt-1\"><code>{{ response }}</code></pre> -->\r\n          <iframe\r\n            name=\"result\"\r\n            allow=\"midi; geolocation; microphone; camera; display-capture; encrypted-media;\"\r\n            sandbox=\"allow-modals allow-forms allow-scripts allow-same-origin allow-popups allow-top-navigation-by-user-activation allow-downloads\"\r\n            allowfullscreen=\"\"\r\n            allowpaymentrequest=\"\"\r\n            frameborder=\"0\"\r\n            style=\"width: 100%; height: 50vh;\"\r\n            :srcdoc=\"response\"\r\n          />\r\n        </template>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as fields from \"@/fields\";\r\nimport { API } from \"@/http-common\";\r\nimport { getCookie } from \"@/common.js\"\r\nimport Submit from \"@/components/Submit.vue\"\r\nexport default {\r\n  name: \"CreateResponse\",\r\n  components : Object.assign({}, {Submit}, fields),\r\n  data() {\r\n    return {\r\n      api_data: undefined,\r\n      form : undefined,\r\n      response: undefined,\r\n      event: undefined,\r\n      section : 0,\r\n      success : undefined,\r\n      loading : false\r\n    };\r\n  },\r\n  async created() {\r\n    await Promise.all([\r\n      API.get(\"form/\".concat(this.$route.params.id))\r\n        .then((response) => this.api_data = response.data),\r\n      API.get(\"event/\".concat(this.$route.query.event))\r\n        .then((response) => this.event = response.data)\r\n      ]\r\n    )\r\n\r\n    if (this.$route.query?.edit) {\r\n      await API.get(\"formAnswer/\".concat(this.$route.query.edit))\r\n        .then((response) =>\r\n            this.form = response.data\r\n        );\r\n    }\r\n    else\r\n      this.form = {\r\n        content : { sections : []},\r\n        form: this.api_data.id,\r\n        event: this.event.id\r\n      };\r\n    this.initializeData();\r\n  },\r\n  methods: {\r\n    leave() {\r\n      if (this.section > 0) {\r\n        this.section--;\r\n        this.$nextTick(() => this.$refs['formtitle'].scrollIntoView({behavior: 'smooth'}));\r\n      }\r\n      else\r\n        location.href='/forms'\r\n    },\r\n    submit() {\r\n      if (this.section < this.api_data.form.sections.length-1) {\r\n        this.section++;\r\n        this.$nextTick(() => this.$refs['formtitle'].scrollIntoView({behavior: 'smooth'}));\r\n      }\r\n      else {\r\n        this.loading = true;\r\n        var method;\r\n        var url;\r\n        var successMessage;\r\n        if (this.form.id === undefined)  {\r\n          method = \"post\";\r\n          url = \"/formAnswer/\";\r\n          successMessage = \"A resposta foi enviada com sucesso.\";\r\n          }\r\n        else {\r\n          method = \"put\";\r\n          url = \"/formAnswer/\".concat(this.form.id).concat(\"/\");\r\n          successMessage = \"A resposta foi editada com sucesso.\";\r\n        }\r\n        var options = {\r\n          method : method,\r\n          url : url,\r\n          headers: {\r\n            \"X-CSRFToken\": getCookie(\"csrftoken\"),\r\n          },\r\n          data: this.form,\r\n          transformResponse: [\r\n            async (data) => {\r\n              this.loading = undefined;\r\n              try {\r\n                this.response = JSON.parse(data);\r\n                this.form = this.response;\r\n                this.success = successMessage;\r\n                this.section++;\r\n              } catch (e) {this.response = data;}\r\n              return this.response;\r\n            },\r\n          ],\r\n        };\r\n        API(options);\r\n      }\r\n    },\r\n    updateAnswer(value) {\r\n      this.form.content.sections[value.sectionIndex][value.questionIndex][\"answer\"] = value[\"answer\"];\r\n    },\r\n    initializeData() {\r\n      for (var section in this.api_data.form.sections) {\r\n        this.form.content.sections[section] = [];\r\n        for (var question in this.api_data.form.sections[section].questions) {\r\n          this.form.content.sections[section][question] = {\r\n            field_type : this.api_data.form.sections[section].questions[question].properties[\"field_type\"],\r\n          };\r\n        }\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n<style scoped lang=\"scss\">\r\n  $primary : #3273dc;\r\n  @import \"@/styles/bulma-steps.min.scss\";\r\n\r\n  .steps:not(.is-hollow) .steps-segment.is-active .steps-marker:not(.is-hollow) {\r\n    background-color: $primary;\r\n  }\r\n\r\n  .steps:not(.is-hollow) .steps-marker:not(.is-hollow),\r\n  .steps-segment:after {\r\n    background-color:darken($primary, 35%);\r\n  }\r\n\r\n  .steps-segment:after {\r\n    box-sizing: content-box;\r\n    margin: 0 !important;\r\n  }\r\n  \r\n</style>","import { render } from \"./CreateResponse.vue?vue&type=template&id=0d9e649c&scoped=true\"\nimport script from \"./CreateResponse.vue?vue&type=script&lang=js\"\nexport * from \"./CreateResponse.vue?vue&type=script&lang=js\"\n\nimport \"./CreateResponse.vue?vue&type=style&index=0&id=0d9e649c&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-0d9e649c\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CreateResponse.vue?vue&type=style&index=0&id=0d9e649c&scoped=true&lang=scss\""],"sourceRoot":""}