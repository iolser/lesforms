(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b688d"],{"1e25":function(e,t,a){"use strict";a.r(t);var s=a("7a23"),n={key:0,id:"responses",class:"table-container box"},c={class:"table is-striped is-hoverable is-fullwidth",style:{border:"1px solid #dbdbdb"}},i={class:"mb-0 p-2"},r={class:"title"},o=Object(s["createVNode"])("br",null,null,-1),l=Object(s["createVNode"])("span",{class:"subtitle"},"Registo de participantes ",-1),d=Object(s["createVNode"])("th",{style:{"text-align":"center","vertical-align":"middle"}}," Participante ",-1),u={key:0,style:{"text-align":"center","vertical-align":"middle"}},p=Object(s["createVNode"])("th",{style:{"text-align":"center","vertical-align":"middle"}}," Estado ",-1),b={class:"p-0"},h={class:"field"},f={class:"control has-icons-left"},j=Object(s["createVNode"])("span",{class:"icon is-small is-left"},[Object(s["createVNode"])("i",{class:"fas fa-search"})],-1),O={key:0,class:"p-0"},m={class:"field"},v={class:"control has-icons-left"},g=Object(s["createVNode"])("span",{class:"icon is-small is-left"},[Object(s["createVNode"])("i",{class:"fas fa-search"})],-1),k={class:"p-0"},S={class:"field"},V={class:"control has-icons-left"},N=Object(s["createVNode"])("span",{class:"icon is-small is-left"},[Object(s["createVNode"])("i",{class:"fas fa-search"})],-1),w={class:"author"},y=Object(s["createTextVNode"])(" Anónimo "),_=Object(s["createVNode"])("br",null,null,-1),B={key:0},x={align:"center",style:{"vertical-align":"middle"}},C={key:0,class:"is-danger connection-error"},D={key:3};function q(e,t,a,q,A,R){return A.api_data?(Object(s["openBlock"])(),Object(s["createBlock"])("div",n,[Object(s["createVNode"])("table",c,[Object(s["createVNode"])("caption",i,[Object(s["createVNode"])("span",r,Object(s["toDisplayString"])(A.api_data.title),1),o,l]),Object(s["createVNode"])("thead",null,[Object(s["createVNode"])("tr",null,[d,A.event?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createBlock"])("th",u," Evento ")),p]),Object(s["createVNode"])("tr",null,[Object(s["createVNode"])("th",b,[Object(s["createVNode"])("div",h,[Object(s["createVNode"])("div",f,[Object(s["withDirectives"])(Object(s["createVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return A.authorSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por autor"},null,512),[[s["vModelText"],A.authorSearch]]),j])])]),A.event?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createBlock"])("th",O,[Object(s["createVNode"])("div",m,[Object(s["createVNode"])("div",v,[Object(s["withDirectives"])(Object(s["createVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return A.eventSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por evento"},null,512),[[s["vModelText"],A.eventSearch]]),g])])])),Object(s["createVNode"])("th",k,[Object(s["createVNode"])("div",S,[Object(s["createVNode"])("div",V,[Object(s["withDirectives"])(Object(s["createVNode"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return A.statusSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por estado (Validada / Presente)"},null,512),[[s["vModelText"],A.statusSearch]]),N])])])])]),Object(s["createVNode"])("tbody",null,[(Object(s["openBlock"])(!0),Object(s["createBlock"])(s["Fragment"],null,Object(s["renderList"])(R.filteredResponses(),(function(e,t){return Object(s["openBlock"])(),Object(s["createBlock"])("tr",{key:t},[Object(s["createVNode"])("td",w,[e.author?(Object(s["openBlock"])(),Object(s["createBlock"])("span",{key:0,href:"/profile/"+e.answerer},Object(s["toDisplayString"])(e.author),9,["href"])):(Object(s["openBlock"])(),Object(s["createBlock"])(s["Fragment"],{key:1},[y],64)),Object(s["createVNode"])("span",{title:new Date(e.created_at).toLocaleString()},", há "+Object(s["toDisplayString"])(R.timeSince(e.created_at)),9,["title"]),e.created_at!=e.updated_at?(Object(s["openBlock"])(),Object(s["createBlock"])("span",{key:2,class:e.created_at!=e.updated_at?"edited":"",title:"Editado por "+(e.editor?e.editor:"Anónimo")+" há "+R.timeSince(e.updated_at)+" ("+new Date(e.updated_at).toLocaleString()+")"},"*",10,["title"])):Object(s["createCommentVNode"])("",!0),_,Object(s["createVNode"])("a",{href:"/forms/respond/"+e.id+"?event="+e.event},"Editar Resposta",8,["href"])]),A.event?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createBlock"])("td",B,Object(s["toDisplayString"])(e.eventName),1)),Object(s["createVNode"])("td",x,["error"===A.loading_status[e.id]?(Object(s["openBlock"])(),Object(s["createBlock"])("span",C," Houve um erro de conexão. Por favor recarregue a página. ")):2==A.answerStatuses[e.id]?(Object(s["openBlock"])(),Object(s["createBlock"])("button",{key:1,class:[{"is-loading is-warning":"loading"===A.loading_status[e.id],"is-success":"loading"!==A.loading_status[e.id]},"button"],type:"button",onClick:function(t){A.answerStatuses[e.id]=4,R.changeStatus(e.id,A.answerStatuses[e.id])}}," Efetuar registo de participante ",10,["onClick"])):4==A.answerStatuses[e.id]?(Object(s["openBlock"])(),Object(s["createBlock"])("button",{key:2,class:[{"is-loading is-success":"loading"===A.loading_status[e.id],"is-warning":"loading"!==A.loading_status[e.id]},"button"],type:"button",onClick:function(t){A.answerStatuses[e.id]=2,R.changeStatus(e.id,A.answerStatuses[e.id])}}," Cancelar registo de participante ",10,["onClick"])):(Object(s["openBlock"])(),Object(s["createBlock"])("span",D," Inscrição não validada "))])])})),128))])])])):Object(s["createCommentVNode"])("",!0)}var A=a("1da1"),R=(a("96cf"),a("99af"),a("b0c0"),a("a434"),a("4de4"),a("3f6f")),P=a("c427"),T=a("69d9"),E={name:"ViewAllResponses",components:R,data:function(){return{api_data:void 0,form_responses:[],displayed_sections:[],event:void 0,user:void 0,statuses:{},authorSearch:"",eventSearch:"",statusSearch:"",answerStatuses:[],interval:void 0,loading_status:{}}},created:function(){var e=this,t=P["a"].get("form/".concat(this.$route.params.id)).then((function(t){return e.initializeData(t)})),a="formAnswer/?form=".concat(this.$route.params.id);void 0!==this.$route.query.event&&(a=a.concat("&event=").concat(this.$route.query.event),P["a"].get("event/".concat(this.$route.query.event)).then((function(t){return e.event=t.data.name}))),P["a"].get(a).then(function(){var a=Object(A["a"])(regeneratorRuntime.mark((function a(s){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t;case 2:e.initializeAnswers(s);case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),P["a"].get("answerStatus/").then((function(t){e.statuses=t.data})),this.getStatuses()},methods:{getStatuses:function(){var e=this;P["a"].get("formAnswerStatus/").then((function(t){e.answerStatuses=t.data}))},changeStatus:function(e,t){this.loading_status[e]="loading",setTimeout(this.patchStatus.bind(this,e,t),0)},patchStatus:function(e,t){var a=this,s={method:"patch",url:"/formAnswerStatus/"+e+"/",headers:{"X-CSRFToken":Object(T["b"])("csrftoken")},data:{status:t},transformResponse:[function(e){return a.response=e,e}]};Object(P["a"])(s).then((function(){return a.loading_status[e]=void 0})).catch((function(t){console.log(t),a.loading_status[e]="error",a.answerStatuses[e]="error"}))},initializeData:function(e){this.api_data=Object(T["d"])(e.data);for(var t=0;t<this.api_data.form.sections.length;)this.api_data.form.sections[t].questions.length>0?this.displayed_sections[t++]=!0:this.api_data.form.sections.splice(t,1)},initializeAnswers:function(e){this.form_responses=Object(T["a"])(e.data,this.api_data)},allFalse:function(){for(var e=0;e<this.displayed_sections.length;e++)if(1==this.displayed_sections[e])return!1;return!0},filteredResponses:function(){var e=this,t=this.form_responses;""!=this.authorSearch&&(t=t.filter((function(t){return Object(T["e"])(void 0===t.author?"Anónimo":t.author,e.authorSearch)}))),""!=this.eventSearch&&(t=t.filter((function(t){return!!t.eventName&&Object(T["e"])(t.eventName,e.eventSearch)}))),""!=this.statusSearch&&(t=t.filter((function(t){return Object(T["e"])(e.statuses[e.answerStatuses[t.id]].name,e.statusSearch)})));for(var a=0;a<this.api_data.form.sections.length;a++)if(this.displayed_sections[a])for(var s=this.api_data.form.sections[a],n=0;n<s.questions.length;n++){var c=s.questions[n];c.filter&&""!=c.filter&&(t=t.filter((function(e){return Object(T["e"])(String(e.content.sections[a][n].answer),c.filter)})))}return t},timeSince:T["f"]}};E.render=q;t["default"]=E}}]);
//# sourceMappingURL=chunk-2d0b688d.56f19d4a.js.map