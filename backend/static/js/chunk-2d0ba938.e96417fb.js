(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ba938"],{3896:function(e,t,c){"use strict";c.r(t);c("4de4"),c("b0c0"),c("caad"),c("2532"),c("d3b7");var a=c("7a23"),s={key:0,id:"responses",class:"table-container box"},n={class:"table is-striped is-hoverable is-fullwidth",style:{border:"1px solid #dbdbdb"}},o={class:"mb-0 p-2"},r={class:"title"},i=Object(a["createVNode"])("br",null,null,-1),l=Object(a["createVNode"])("span",{class:"subtitle"},"Respostas",-1),d=Object(a["createVNode"])("th",{style:{"text-align":"center","vertical-align":"middle"},rowspan:"3"}," Autor da Resposta ",-1),u={key:0,style:{"text-align":"center","vertical-align":"middle"},rowspan:"3"},b=Object(a["createVNode"])("th",{style:{"text-align":"center","vertical-align":"middle"},rowspan:"3"}," Estado ",-1),p={class:"p-0"},j={class:"field"},O={class:"control has-icons-left"},h=Object(a["createVNode"])("span",{class:"icon is-small is-left"},[Object(a["createVNode"])("i",{class:"fas fa-search"})],-1),f={key:0,class:"p-0"},k={class:"field"},m={class:"control has-icons-left"},v=Object(a["createVNode"])("span",{class:"icon is-small is-left"},[Object(a["createVNode"])("i",{class:"fas fa-search"})],-1),y={class:"p-0"},g={class:"field"},B={class:"control has-icons-left"},V=Object(a["createVNode"])("span",{class:"icon is-small is-left"},[Object(a["createVNode"])("i",{class:"fas fa-search"})],-1),N={style:{display:"contents"}},S={class:"field"},w={class:"control has-icons-left"},_=Object(a["createVNode"])("span",{class:"icon is-small is-left"},[Object(a["createVNode"])("i",{class:"fas fa-search"})],-1),x={class:"author"},D=Object(a["createTextVNode"])(" Anónimo "),q=Object(a["createVNode"])("br",null,null,-1),F={key:0},C={style:{"vertical-align":"middle"}},L={key:0,value:"error",unselectable:""},A={style:{display:"contents"}},R=Object(a["createTextVNode"])(" Sem resposta "),T={class:"has-background-grey-lighter"};function U(e,t,c,U,E,$){return E.api_data?(Object(a["openBlock"])(),Object(a["createBlock"])("div",s,[Object(a["createVNode"])("table",n,[Object(a["createVNode"])("caption",o,[Object(a["createVNode"])("span",r,Object(a["toDisplayString"])(E.api_data.title),1),i,l]),Object(a["createVNode"])("thead",null,[Object(a["createVNode"])("tr",null,[d,E.event?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("th",u," Evento ")),b,(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(E.api_data.form.sections,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("th",{key:t,style:{"text-align":"center","vertical-align":"middle"},colspan:1==E.displayed_sections[t]?e.questions.length:1,class:"section-first section-last"},Object(a["toDisplayString"])(e.section_name),9,["colspan"])})),128))]),Object(a["createVNode"])("tr",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(E.api_data.form.sections,(function(e,t){return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createBlock"])("div",{key:t,style:{display:"contents"}},[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.questions,(function(t,c){return Object(a["openBlock"])(),Object(a["createBlock"])("th",{key:c,class:{"section-first":0===c,"section-last":c===e.questions.length-1}},Object(a["toDisplayString"])(t.question),3)})),128))],512)),[[a["vShow"],1==E.displayed_sections[t]]])})),128))]),Object(a["createVNode"])("tr",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(E.api_data.form.sections,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("th",{key:t,class:["p-0",E.displayed_sections[t]?"section-first section-last":""],colspan:E.displayed_sections[t]?e.questions.length:1,rowspan:1==E.displayed_sections[t]?1:2},[Object(a["createVNode"])("div",{class:["button is-info is-fullwidth",E.displayed_sections[t]?"is-light":"is-small mt-1px"],onClick:function(e){E.displayed_sections[t]=!E.displayed_sections[t]}},Object(a["toDisplayString"])(E.displayed_sections[t]?"Esconder secção":"Ver secção"),11,["onClick"])],10,["colspan","rowspan"])})),128))]),Object(a["createVNode"])("tr",null,[Object(a["createVNode"])("th",p,[Object(a["createVNode"])("div",j,[Object(a["createVNode"])("div",O,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return E.authorSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por autor"},null,512),[[a["vModelText"],E.authorSearch]]),h])])]),E.event?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("th",f,[Object(a["createVNode"])("div",k,[Object(a["createVNode"])("div",m,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return E.eventSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por evento"},null,512),[[a["vModelText"],E.eventSearch]]),v])])])),Object(a["createVNode"])("th",y,[Object(a["createVNode"])("div",g,[Object(a["createVNode"])("div",B,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return E.statusSearch=e}),type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por estado"},null,512),[[a["vModelText"],E.statusSearch]]),V])])]),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(E.api_data.form.sections,(function(c,s){return Object(a["openBlock"])(),Object(a["createBlock"])("div",{key:s,style:{display:"contents"}},[Object(a["withDirectives"])(Object(a["createVNode"])("div",N,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(c.questions,(function(s,n){return Object(a["openBlock"])(),Object(a["createBlock"])("th",{key:n,class:["p-0 field",{"section-first":0===n,"section-last":n===c.questions.length-1}]},[Object(a["createVNode"])("div",S,[Object(a["createVNode"])("div",w,[Object(a["withDirectives"])(Object(a["createVNode"])("input",{"onUpdate:modelValue":function(e){return s.filter=e},type:"text",class:"input is-info is-small m-0",placeholder:"Pesquisar por "+s.question,onInput:t[4]||(t[4]=function(){return e.filter&&e.filter.apply(e,arguments)})},null,40,["onUpdate:modelValue","placeholder"]),[[a["vModelText"],s.filter]]),_])])],2)})),128))],512),[[a["vShow"],E.displayed_sections[s]]])])})),128))])]),Object(a["createVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])($.filteredResponses(),(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("tr",{key:t},[Object(a["createVNode"])("td",x,[e.author?(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:0,href:"/profile/"+e.answerer},Object(a["toDisplayString"])(e.author),9,["href"])):(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:1},[D],64)),Object(a["createVNode"])("span",{title:new Date(e.created_at).toLocaleString()},", há "+Object(a["toDisplayString"])($.timeSince(e.created_at)),9,["title"]),e.created_at!=e.updated_at?(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:2,class:e.created_at!=e.updated_at?"edited":"",title:"Editado por "+(e.editor?e.editor:"Anónimo")+" há "+$.timeSince(e.updated_at)+" ("+new Date(e.updated_at).toLocaleString()+")"},"*",10,["title"])):Object(a["createCommentVNode"])("",!0),q,Object(a["createVNode"])("a",{href:"/forms/respond/"+e.id+"?event="+e.event},"Editar Resposta",8,["href"])]),E.event?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("td",F,Object(a["toDisplayString"])(e.eventName),1)),Object(a["createVNode"])("td",C,[Object(a["createVNode"])("div",{class:["select is-rounded is-fullwidth",{"is-loading":"loading"===E.loading_status[e.id],"is-danger connection-error":"error"===E.loading_status[e.id]}]},[Object(a["withDirectives"])(Object(a["createVNode"])("select",{"onUpdate:modelValue":function(t){return E.answerStatuses[e.id]=t},style:[{"border-width":"2.5px"},{borderColor:"error"!==E.loading_status[e.id]?E.statuses[E.answerStatuses[e.id]].color:""}],onChange:function(t){return $.changeStatus(e.id,E.answerStatuses[e.id])}},["error"===E.loading_status[e.id]?(Object(a["openBlock"])(),Object(a["createBlock"])("option",L," Erro de conexão ")):Object(a["createCommentVNode"])("",!0),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(E.statuses,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("option",{key:t,value:t},Object(a["toDisplayString"])(e.name),9,["value"])})),128))],44,["onUpdate:modelValue","onChange"]),[[a["vModelSelect"],E.answerStatuses[e.id]]])],2)]),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.content.sections,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("div",{key:t,style:{display:"contents"}},[Object(a["withDirectives"])(Object(a["createVNode"])("div",A,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e,(function(t,c){return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[t.field_type.includes("exposition")?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])("td",{key:c,style:void 0===t.answer?"background-color: rgba(0, 0, 0, 0.25);":"",class:{"section-first":0===c,"section-last":c===e.length-1}},[void 0!==t.answer?(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:0},["[object Array]"===Object.prototype.toString.call(t.answer)?(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],{key:0},Object(a["renderList"])(t.answer,(function(e,t){return Object(a["openBlock"])(),Object(a["createBlock"])("li",{key:t},Object(a["toDisplayString"])(e),1)})),128)):(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:1},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.answer),1)],64))],64)):(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:1},[R],64))],6))],64)})),256))],512),[[a["vShow"],E.displayed_sections[t]]]),Object(a["withDirectives"])(Object(a["createVNode"])("td",T,null,512),[[a["vShow"],0==E.displayed_sections[t]]])])})),128))])})),128))])])])):Object(a["createCommentVNode"])("",!0)}var E=c("1da1"),$=(c("96cf"),c("99af"),c("a434"),c("3f6f")),M=c("c427"),z=c("69d9"),P={name:"ViewAllResponses",components:$,data:function(){return{api_data:void 0,form_responses:[],displayed_sections:[],event:void 0,user:void 0,statuses:{},authorSearch:"",eventSearch:"",statusSearch:"",answerStatuses:[],interval:void 0,loading_status:{}}},created:function(){var e=this,t=M["a"].get("form/".concat(this.$route.params.id)).then((function(t){return e.initializeData(t)})),c="formAnswer/?form=".concat(this.$route.params.id);void 0!==this.$route.query.event&&(c=c.concat("&event=").concat(this.$route.query.event)),void 0!==this.$route.query.user&&(c=c.concat("&user=").concat(this.$route.query.user)),M["a"].get(c).then(function(){var c=Object(E["a"])(regeneratorRuntime.mark((function c(a){return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return c.next=2,t;case 2:e.initializeAnswers(a);case 3:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}()),M["a"].get("answerStatus/").then((function(t){e.statuses=t.data})),this.getStatuses()},methods:{getStatuses:function(){var e=this;M["a"].get("formAnswerStatus/").then((function(t){e.answerStatuses=t.data}))},changeStatus:function(e,t){this.loading_status[e]="loading",setTimeout(this.patchStatus.bind(this,e,t),0)},patchStatus:function(e,t){var c=this,a={method:"patch",url:"/formAnswerStatus/"+e+"/",headers:{"X-CSRFToken":Object(z["b"])("csrftoken")},data:{status:t},transformResponse:[function(e){return c.response=e,e}]};Object(M["a"])(a).then((function(){return c.loading_status[e]=void 0})).catch((function(t){console.log(t),c.loading_status[e]="error",c.answerStatuses[e]="error"}))},initializeData:function(e){this.api_data=Object(z["d"])(e.data);for(var t=0;t<this.api_data.form.sections.length;)this.api_data.form.sections[t].questions.length>0?this.displayed_sections[t++]=!0:this.api_data.form.sections.splice(t,1)},initializeAnswers:function(e){this.form_responses=Object(z["a"])(e.data,this.api_data)},allFalse:function(){for(var e=0;e<this.displayed_sections.length;e++)if(1==this.displayed_sections[e])return!1;return!0},filteredResponses:function(){var e=this,t=this.form_responses;""!=this.authorSearch&&(t=t.filter((function(t){return Object(z["e"])(void 0===t.author?"Anónimo":t.author,e.authorSearch)}))),""!=this.eventSearch&&(t=t.filter((function(t){return!!t.eventName&&Object(z["e"])(t.eventName,e.eventSearch)}))),""!=this.statusSearch&&(t=t.filter((function(t){return Object(z["e"])(e.statuses[e.answerStatuses[t.id]].name,e.statusSearch)})));for(var c=0;c<this.api_data.form.sections.length;c++)if(this.displayed_sections[c])for(var a=this.api_data.form.sections[c],s=0;s<a.questions.length;s++){var n=a.questions[s];n.filter&&""!=n.filter&&(t=t.filter((function(e){return Object(z["e"])(String(e.content.sections[c][s].answer),n.filter)})))}return t},timeSince:z["f"]}};P.render=U;t["default"]=P}}]);
//# sourceMappingURL=chunk-2d0ba938.e96417fb.js.map